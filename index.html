<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modern To Do App</title>
   <!-- Favicon -->
  <link rel="icon" type="image/png" href="checklist.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --glass: rgba(255,255,255,0.04);
      --accent:#7c5cff;
      --muted:#94a3b8;
      --success:#22c55e;
      --danger:#ff7b7b;
      --glass-2: rgba(255,255,255,0.02);
      --radius:14px;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,0.12), transparent),
                  radial-gradient(900px 400px at 90% 90%, rgba(34,197,94,0.06), transparent),
                  var(--bg);
      display:flex; align-items:center; justify-content:center; padding:32px;
    }

    .app{
      width:min(920px,96vw);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:20px; padding:28px; box-shadow: 0 8px 30px rgba(2,6,23,0.7);
      display:grid; grid-template-columns: 1fr 360px; gap:20px; align-items:start;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      border-radius:16px; padding:18px; backdrop-filter: blur(6px);
      border: 1px solid var(--glass-2);
    }

    header.app-head{
      grid-column:1 / -1; display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .title{
      display:flex; gap:14px; align-items:center;
    }
    .logo{
      width:56px; height:56px; border-radius:12px; display:grid; place-items:center;
      background: linear-gradient(135deg,var(--accent), #5eead4);
      color:white; font-weight:700; font-size:18px; box-shadow: 0 6px 18px rgba(124,92,255,0.18);
    }
    .title h1{margin:0; font-size:20px}
    .title p{margin:0; color:var(--muted); font-size:13px}

    /* main input */
    .composer{display:flex; gap:10px; margin-top:10px}
    .composer input[type=text]{flex:1; padding:12px 14px; border-radius:12px; border:1px solid var(--glass);
      background:transparent; color:#e6eef8; font-size:14px; outline:none}
    .btn{
      background:var(--accent); color:white; border:none; padding:10px 14px; border-radius:12px; cursor:pointer;
      font-weight:600; box-shadow: 0 6px 16px rgba(124,92,255,0.12);
    }
    .btn.secondary{background:transparent; color:var(--muted); border:1px solid var(--glass-2); box-shadow:none}

    /* list */
    .list{margin-top:18px; display:flex; flex-direction:column; gap:10px; max-height:58vh; overflow:auto; padding-right:6px}
    .task{
      display:flex; gap:12px; align-items:center; padding:10px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));
      border:1px solid rgba(255,255,255,0.02);
    }
    .task.dragging{opacity:0.6; transform:scale(0.995)}

    .check{
      width:40px; height:40px; display:grid; place-items:center; border-radius:10px; border:1px solid var(--glass);
      cursor:pointer; flex-shrink:0
    }
    .check input{width:18px; height:18px}
    .task-content{flex:1; min-width:0}
    .task-content p{margin:0; font-size:15px; color:#e6eef8; word-break:break-word}
    .task-content p.completed{text-decoration:line-through; color:var(--muted)}
    .meta{display:flex; gap:10px; align-items:center; margin-top:6px}
    .chip{font-size:12px; color:var(--muted); background:transparent; border-radius:999px; padding:4px 8px; border:1px solid var(--glass-2)}

    .actions{display:flex; gap:8px; align-items:center}
    .icon-btn{background:transparent; border:none; padding:8px; border-radius:8px; cursor:pointer}
    .icon-btn svg{width:18px; height:18px; opacity:0.9}

    aside.right{
      display:flex; flex-direction:column; gap:14px; min-width:240px
    }
    .stats{display:flex; gap:12px; align-items:center}
    .stat{flex:1; padding:12px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015)); border:1px solid var(--glass-2)}
    .filters{display:flex; gap:8px; align-items:center; margin-top:6px}
    .filters button{padding:8px 12px; border-radius:999px; border:1px solid var(--glass-2); background:transparent; color:var(--muted); cursor:pointer}
    .filters button.active{background:linear-gradient(90deg,var(--accent), #5eead4); color:#021124; font-weight:600; border:none}

    .empty{padding:36px; text-align:center; color:var(--muted)}

    /* responsive */
    @media(max-width:880px){
      .app{grid-template-columns:1fr; padding:18px}
      aside.right{order:2}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="To Do app">
    <header class="app-head">
      <div class="title">
        <div class="logo">TD</div>
        <div>
          <h1>Modern To Do</h1>
          <p>Simple. Fast. Private. Works offline.</p>
        </div>
      </div>
      <div style="text-align:right">
        <small style="color:var(--muted)">Built with plain JavaScript</small>
      </div>
    </header>

    <main class="panel" aria-live="polite">
      <div class="composer" role="region" aria-label="Add task">
        <input id="newTask" type="text" placeholder="Add a new task and press enter" aria-label="New task" />
        <button id="addBtn" class="btn" aria-label="Add task">Add</button>
      </div>

      <div class="list" id="taskList" aria-label="Tasks list">
        <!-- tasks go here -->
      </div>

      <div style="display:flex; justify-content:space-between; margin-top:14px; align-items:center">
        <div id="leftCount" style="color:var(--muted); font-size:13px">0 tasks</div>
        <div style="display:flex; gap:8px">
          <button id="clearCompleted" class="btn secondary">Clear completed</button>
          <button id="exportBtn" class="btn secondary">Export</button>
        </div>
      </div>
    </main>

    <aside class="panel right">
      <div class="stat">
        <div style="font-size:13px; color:var(--muted)">Overview</div>
        <div class="stats" style="margin-top:10px">
          <div class="stat" style="padding:8px">
            <div style="font-size:22px; font-weight:700" id="total">0</div>
            <div style="font-size:12px; color:var(--muted)">Total</div>
          </div>
          <div class="stat" style="padding:8px">
            <div style="font-size:22px; font-weight:700" id="active">0</div>
            <div style="font-size:12px; color:var(--muted)">Active</div>
          </div>
        </div>
      </div>

      <div class="stat">
        <div style="font-size:13px; color:var(--muted)">Filters</div>
        <div class="filters" role="tablist" aria-label="Filters">
          <button class="active" data-filter="all">All</button>
          <button data-filter="active">Active</button>
          <button data-filter="completed">Completed</button>
        </div>
      </div>

      <div class="stat">
        <div style="font-size:13px; color:var(--muted)">Tips</div>
        <div class="empty" style="padding:12px; font-size:13px">
          Click task text to edit. Drag to reorder. Data is saved locally in your browser.
        </div>
      </div>

    </aside>
  </div>

  <script>
    // Simple To Do with localStorage, edit, delete, drag and drop
    const TASK_KEY = 'modern_todo_v1';

    const newTaskInput = document.getElementById('newTask');
    const addBtn = document.getElementById('addBtn');
    const taskListEl = document.getElementById('taskList');
    const totalEl = document.getElementById('total');
    const activeEl = document.getElementById('active');
    const leftCount = document.getElementById('leftCount');
    const clearCompletedBtn = document.getElementById('clearCompleted');
    const exportBtn = document.getElementById('exportBtn');
    const filters = document.querySelectorAll('.filters button');

    let tasks = [];
    let filter = 'all';
    let dragSrcId = null;

    // load from localStorage
    function load(){
      try{
        const raw = localStorage.getItem(TASK_KEY);
        tasks = raw ? JSON.parse(raw) : [];
      }catch(e){ tasks = [] }
    }

    function save(){
      localStorage.setItem(TASK_KEY, JSON.stringify(tasks));
      render();
    }

    function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,7) }

    function addTask(text){
      if(!text || !text.trim()) return;
      tasks.unshift({ id: uid(), text: text.trim(), completed:false, created: Date.now() });
      save();
      newTaskInput.value = '';
      newTaskInput.focus();
    }

    function updateCounts(){
      totalEl.textContent = tasks.length;
      activeEl.textContent = tasks.filter(t => !t.completed).length;
      leftCount.textContent = `${tasks.filter(t=>!t.completed).length} tasks left`;
    }

    function setFilter(f){
      filter = f;
      filters.forEach(b=> b.classList.toggle('active', b.dataset.filter===f));
      render();
    }

    function clearCompleted(){
      tasks = tasks.filter(t => !t.completed);
      save();
    }

    function exportTasks(){
      const data = JSON.stringify(tasks, null, 2);
      const blob = new Blob([data], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'tasks.json';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    }

    function editTask(id, newText){
      const t = tasks.find(x=>x.id===id);
      if(t){ t.text = newText.trim(); t.updated = Date.now(); save(); }
    }

    function toggleComplete(id){
      const t = tasks.find(x=>x.id===id);
      if(t){ t.completed = !t.completed; save(); }
    }

    function deleteTask(id){
      tasks = tasks.filter(x=>x.id!==id);
      save();
    }

    function findTaskIndex(id){ return tasks.findIndex(x=>x.id===id) }

    function moveTask(fromIndex, toIndex){
      if(fromIndex===toIndex || fromIndex<0 || toIndex<0) return;
      const [item] = tasks.splice(fromIndex,1);
      tasks.splice(toIndex,0,item);
      save();
    }

    // Render
    function render(){
      taskListEl.innerHTML = '';
      const visible = tasks.filter(t => {
        if(filter==='all') return true;
        if(filter==='active') return !t.completed;
        return t.completed;
      });

      if(visible.length===0){
        taskListEl.innerHTML = `<div class="empty">No tasks yet. Add your first task.</div>`;
      }else{
        visible.forEach((task, i) => {
          const li = document.createElement('div');
          li.className = 'task';
          li.draggable = true;
          li.dataset.id = task.id;

          // drag events
          li.addEventListener('dragstart', e=>{
            li.classList.add('dragging');
            dragSrcId = task.id;
            e.dataTransfer.effectAllowed = 'move';
          });
          li.addEventListener('dragend', e=>{ li.classList.remove('dragging'); dragSrcId = null });

          li.addEventListener('dragover', e=>{
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
          });

          li.addEventListener('drop', e=>{
            e.preventDefault();
            const targetId = li.dataset.id;
            const from = findTaskIndex(dragSrcId);
            const to = findTaskIndex(targetId);
            if(from>-1 && to>-1){ moveTask(from, to); }
          });

          li.innerHTML = `
            <div class="check" title="Mark complete" role="button" tabindex="0">
              <input type="checkbox" ${task.completed ? 'checked' : ''} aria-label="Mark complete" />
            </div>
            <div class="task-content">
              <p class="${task.completed ? 'completed' : ''}" tabindex="0">${escapeHtml(task.text)}</p>
              <div class="meta">
                <div class="chip">${timeAgo(task.created)}</div>
                ${task.updated ? '<div class="chip">edited</div>' : ''}
              </div>
            </div>
            <div class="actions">
              <button class="icon-btn edit" title="Edit" aria-label="Edit task">${iconEdit()}</button>
              <button class="icon-btn delete" title="Delete" aria-label="Delete task">${iconDelete()}</button>
              <button class="icon-btn drag" title="Drag to reorder" aria-label="Drag handle">${iconDrag()}</button>
            </div>
          `;

          // events
          const checkbox = li.querySelector('.check input');
          checkbox.addEventListener('change', ()=> toggleComplete(task.id));

          const p = li.querySelector('.task-content p');
          p.addEventListener('dblclick', ()=> startEdit(p, task.id));
          p.addEventListener('keydown', e=>{ if(e.key==='Enter') startEdit(p, task.id) });

          li.querySelector('.edit').addEventListener('click', ()=> startEdit(p, task.id));
          li.querySelector('.delete').addEventListener('click', ()=> { if(confirm('Delete this task?')) deleteTask(task.id) });

          taskListEl.appendChild(li);
        });
      }

      updateCounts();
    }

    // Inline edit
    function startEdit(pEl, id){
      const old = pEl.textContent;
      const input = document.createElement('input');
      input.type = 'text'; input.value = old; input.style.width = '100%'; input.style.fontSize = '15px'; input.style.padding = '6px';
      pEl.replaceWith(input);
      input.focus();
      input.select();

      function commit(){
        const val = input.value.trim();
        if(val) editTask(id, val);
        else deleteTask(id);
      }
      function cancel(){ render(); }

      input.addEventListener('keydown', e=>{
        if(e.key==='Enter') commit();
        if(e.key==='Escape') cancel();
      });
      input.addEventListener('blur', commit);
    }

    // helpers
    function escapeHtml(text){ return text.replace(/[&<>"']/g, function(a){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[a] }) }

    function timeAgo(ts){ const s = Math.floor((Date.now()-ts)/1000);
      if(s<60) return `${s}s ago`;
      const m = Math.floor(s/60); if(m<60) return `${m}m ago`;
      const h = Math.floor(m/60); if(h<24) return `${h}h ago`;
      const d = Math.floor(h/24); return `${d}d ago`;
    }

    // icons
    function iconEdit(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 21l3-1 11-11 1-3-3 1L4 17 3 21z" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>` }
    function iconDelete(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M8 6v12a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><path d="M10 11v6M14 11v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>` }
    function iconDrag(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6h.01M14 6h.01M10 12h.01M14 12h.01M10 18h.01M14 18h.01" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>` }

    // wire up
    addBtn.addEventListener('click', ()=> addTask(newTaskInput.value));
    newTaskInput.addEventListener('keydown', e=>{ if(e.key==='Enter'){ addTask(newTaskInput.value) } });
    clearCompletedBtn.addEventListener('click', ()=> { clearCompleted(); });
    exportBtn.addEventListener('click', exportTasks);
    filters.forEach(b => b.addEventListener('click', ()=> setFilter(b.dataset.filter)));

    // initial load
    load(); render();

    // expose to window for debugging
    window.__todo = { tasks, save, load };
  </script>
</body>
</html>
